# frozen_string_literal: true

required "1:1", "A:?", %w[DIRECTION CURRENCY RATE_BASIS MINIMUM MAXIMUM BASE TON CBM KG RANGE_MIN RANGE_MAX]

column "service",
  sanitizer: "text",
  validator: "string",
  required: true,
  type: :object,
  alternative_keys: ["service_level"],
  fallback: "standard"
column "group_id",
  sanitizer: "text",
  validator: "optional_string",
  required: false,
  type: :object
column "group_name",
  sanitizer: "text",
  validator: "optional_string",
  required: false,
  type: :object
column "effective_date",
  sanitizer: "date",
  validator: "date",
  required: false,
  type: :object
column "expiration_date",
  sanitizer: "date",
  validator: "date",
  required: false,
  type: :object
column "locode",
  sanitizer: "text",
  validator: "optional_locode",
  required: false,
  type: :object
column "hub",
  sanitizer: "text",
  validator: "optional_string",
  required: false,
  type: :object
column "country",
  sanitizer: "text",
  validator: "optional_string",
  required: false,
  type: :object
column "counterpart_locode",
  sanitizer: "text",
  validator: "optional_locode",
  required: false,
  type: :object
column "counterpart_hub",
  sanitizer: "text",
  validator: "optional_string",
  required: false,
  type: :object
column "counterpart_country",
  sanitizer: "text",
  validator: "optional_string",
  required: false,
  type: :object
column "mode_of_transport",
  sanitizer: "downcase",
  validator: "string",
  required: false,
  alternative_keys: ["mot"],
  type: :object
column "carrier",
  sanitizer: "text",
  validator: "string",
  required: false,
  type: :object,
  fallback: organization.slug
column "direction",
  sanitizer: "downcase",
  validator: "direction",
  required: true,
  type: :object
column "service_level",
  sanitizer: "text",
  validator: "string",
  required: false,
  type: :object
column "cargo_class",
  sanitizer: "downcase",
  validator: "cargo_class",
  required: true,
  alternative_keys: ["load_type"],
  type: :object
column "load_type",
  sanitizer: "downcase",
  validator: "cargo_class",
  required: true,
  type: :object
column "terminal",
  sanitizer: "text",
  validator: "optional_string",
  required: false,
  type: :object
column "counterpart_terminal",
  sanitizer: "text",
  validator: "optional_string",
  required: false,
  type: :object
column "min",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  alternative_keys: ["minimum"],
  type: :object
column "max",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  alternative_keys: ["minimum"],
  type: :object
column "fee_name",
  sanitizer: "text",
  validator: "string",
  required: false,
  alternative_keys: ["fee"],
  type: :object
column "fee_code",
  sanitizer: "downcase",
  validator: "string",
  required: false,
  type: :object
column "currency",
  sanitizer: "upcase",
  validator: "currency",
  required: true,
  type: :object
column "rate_basis",
  sanitizer: "text",
  validator: "string",
  required: false,
  type: :object
column "range_min",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "range_max",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "base",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "ton",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "cbm",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "kg",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "item",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "shipment",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "bill",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "container",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "wm",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "percentage",
  sanitizer: "decimal",
  validator: "optional_numeric",
  required: false,
  type: :object
column "dangerous",
  sanitizer: "boolean",
  validator: "optional_boolean",
  default: false,
  required: false,
  type: :object
column "internal",
  sanitizer: "boolean",
  validator: "optional_boolean",
  default: false,
  required: false,
  type: :object

prerequisite "TenantVehicle"
prerequisite "ChargeCategory"

add_validator "SequentialDates"
add_validator "LocalChargeFees"

add_validator "RateBasis"
add_validator "Carrier"
add_validator "TenantVehicle"
add_validator "ChargeCategory"
add_validator "Group"
add_validator "Hub"
add_validator "CounterpartHub"

add_operation "CounterpartHubExpander" if scope.expand_non_counterpart_local_charges

add_formatter "LocalCharge"
conflict Legacy::LocalCharge, %w[hub_id counterpart_hub_id tenant_vehicle_id load_type mode_of_transport group_id direction organization_id]

model_importer Legacy::LocalCharge
target_model Legacy::LocalCharge
