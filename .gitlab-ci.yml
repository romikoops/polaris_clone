variables:
  BUNDLE_GITLAB__COM: "gitlab-ci-token:${CI_JOB_TOKEN}"

pronto:
  stage: test
  image: eu.gcr.io/itsmycargo-main/pronto:stable
  script:
    - scripts/pronto

charge_calculator:
  stage: test
  image: ruby:2.5
  script:
    - "cd lib/charge_calculator; bundle; bundle exec rspec"

rspec:
  stage: test
  image: eu.gcr.io/itsmycargo-main/base:stable
  services:
    - mdillon/postgis
  variables:
    POSTGRES_DB: imcr_test
    DATABASE_URL: postgis://postgres:@localhost/imcr_test
  script:
    - scripts/ci-build.sh bin/rspec

jest:
  stages: test
  image: eu.gcr.io/itsmycargo-main/base:stable

  script:
    - cd client 
    - npm install
    - npm test

