# frozen_string_literal: true

class GenerateLocationGroupsWorker
  include Sidekiq::Worker
  GROUPS = {
    "abu dhabi" => %w[AEAUH AEKHL],
    "ahmedabad" => %w[INAMD INAPI],
    "alexandria" => %w[EGALY EGEDK],
    "alicante" => %w[ESALI ESALC],
    "antalya" => %w[TRAYT TRBTZ],
    "antwerp" => %w[BEANR BEA6N BEANT],
    "aqaba" => %w[JOAQB JOAQJ],
    "athens" => %w[GRATH GRATS],
    "bahrain" => %w[BHBAH BHKBS],
    "bangkok" => %w[THBKK THPAT],
    "baroda" => %w[INBRC INBDQ],
    "batam" => %w[IDBTH IDBTM],
    "beihai" => %w[CNBHY CNBIH CNBHP],
    "beijiao" => %w[CNBJO CNBIJ],
    "beilun" => %w[CNBLG CNBEI],
    "bengbu" => %w[CNBBU CNBFU],
    "bizerte" => %w[TNBIZ TNTUN],
    "bremen" => %w[DEBRV DEBRE DERME],
    "bridgetown" => %w[BBBGI BBBRG],
    "brisbane apt" => %w[AUBNE AUBRA],
    "busan" => %w[KRPUS KRBNP],
    "castries" => %w[LCCAS LCSLU],
    "caucedo" => %w[DOCAU DO004],
    "changchun" => %w[CNCGC CNCGQ],
    "changsha" => %w[CNCSH CNCSX CNCNA],
    "changshu" => %w[CNCGS CNCSJ CNCGU],
    "chengdu" => %w[CNCTU CNCDU],
    "chongqing" => %w[CNCKG CNCHQ CNCQI],
    "colon" => %w[PAONX PACOL],
    "como" => %w[ITOMO ITCMO],
    "dafeng" => %w[CNDFE CNDFG],
    "dandong" => %w[CNDDZ CNDDG],
    "deqing" => %w[CNDEI CNDEQ],
    "derince" => %w[TRDRC TREDI],
    "dezhou" => %w[CNDEZ CNDZS],
    "dublin" => %w[IEDLN IEDUB IELMK IESNN IEORK],
    "duesseldorf" => %w[DEDUS DEDDG],
    "dumyat (damietta)" => %w[EGDAM EGDMI],
    "ezeiza" => %w[AREZE AREZA],
    "fos" => %w[FRFXM FRFOS],
    "foshan" => %w[CNFOS CNFUO],
    "frankfurt" => %w[DEFAD DEFRA],
    "fujairah" => %w[AEOFJ AEFJR],
    "fuzhou" => %w[CNFZG CNFOC CNFZH CNFUZ],
    "gaolan" => %w[CNGON CNGLN],
    "gdansk" => %w[PLGDN PLGDK],
    "geneva" => %w[CHGVA CHGNZ],
    "grand cayman" => %w[KYGCM KYGEC],
    "guadalajara" => %w[MXGDL MXGUA],
    "guangyuan" => %w[CNGBT CNGYS],
    "guangzhou" => %w[CNCAN CNGGZ],
    "gustavia" => %w[BLSBH BLGUS],
    "gwangyang" => %w[KRKWA KRKAN],
    "haikou" => %w[CNHAK CNHKO CNHIG],
    "haimen" => %w[CNHME CNCYH],
    "hakata" => %w[JPHTD JPHKT],
    "hamburg" => %w[DEHAM DEMUN],
    "hangzhou" => %w[CNHAZ CNHGH],
    "harbin" => %w[CNHRB CNHRN],
    "hastings" => %w[NZHAS NZHLZ],
    "heshan" => %w[CNHSN CNHAS],
    "ho chi minh" => %w[VNCMT VNSGN VNCLI VNIPH VNVIC],
    "hong kong" => %w[HKHKG HKCL4],
    "huadu" => %w[CNHDG CNHDU],
    "huaihua" => %w[CNZHI CNHJJ],
    "huaiyin" => %w[CNAIN CNHUY],
    "huangpu" => %w[CNHUA CNWCH],
    "huzhou" => %w[CNHZH CNZHZ],
    "incheon" => %w[KRJCN KRINC],
    "istanbul" => %w[TRIST TRPAM TRKMX TRYPO],
    "izmir" => %w[TRIZM TRI35],
    "jiangyin" => %w[CNJIA CNJGY],
    "jinan" => %w[CNJNA CNTNA],
    "jingzhou" => %w[CNJGZ CNJZK],
    "jining" => %w[CNJNG CNJII CNJNN],
    "jinzhou" => %w[CNJZI CNJNZ],
    "jiujiang" => %w[CNJIU CNJUJ],
    "kaiping" => %w[CNKPN CNKAP],
    "kattupalli" => %w[INKTP INKAT],
    "kobe" => %w[JPUKB JPKOB],
    "kolkata" => %w[INCCU INBNK],
    "labuan" => %w[MYLBH MYLBU],
    "lagos" => %w[NGLOS NGLAG NGAPP NGTIN],
    "laiwu" => %w[CNCSL CNLWS],
    "lanshi" => %w[CNLSI CNLNS],
    "las palmas" => %w[ESLPA ESLPG],
    "lat krabang" => %w[THLKR THLTK],
    "le grand-saconnex" => %w[CHLGS CHLNE],
    "leeds" => %w[GBLBA GBHLU],
    "lisbon" => %w[PTLIS PTCDL],
    "lishui" => %w[CNLSS CNLIS],
    "liuzhou" => %w[CNLZH CNLZU],
    "ljubljana" => %w[SILJA SILJU],
    "london" => %w[GBLON GBLHR GBLOD GBLGP GBLDY],
    "luanda" => %w[AOLAD AOLND],
    "ludwigshafen" => %w[DELWR DELUH],
    "malta" => %w[MTLUQ MTMLA],
    "manila north port" => %w[PHMNN PHMNS PHMNL],
    "mantova" => %w[ITMAN ITVL6],
    "manzanillo" => %w[MXZLO MXLZO],
    "milan" => %w[IT7ML ITMIL ITMXP],
    "moji/kitkyushu" => %w[JPMOJ JPNAH],
    "montreal" => %w[CAMTR CAYMQ],
    "moscow" => %w[RUMOW RUDME],
    "mumbai" => %w[INBOM INBPS],
    "mundra" => %w[INMUN INAJM],
    "nanchang" => %w[CNKHN CNNCH],
    "nanhai" => %w[CNNAH CNHAQ],
    "nanjing" => %w[CNNKG CNNJG CNNJI],
    "nanning" => %w[CNNNG CNNIN],
    "nanyang" => %w[CNNYA CNNYG],
    "new delhi" => %w[INICD INDEL],
    "ningbo" => %w[CNNBG CNNGB CNNBO],
    "novo hamburgo" => %w[BRNHO BRQHV],
    "novorossiysk" => %w[RUNVS RUNOI],
    "nuremberg" => %w[DERGM DENUE],
    "oporto" => %w[PTOPO PTCDO],
    "panama city" => %w[PAPTY PA4PA],
    "panyu" => %w[CNPYU CNPNY],
    "paris" => %w[FRPAR FRPAO],
    "pavia" => %w[ITPAV ITPCZ ITPMO],
    "penang" => %w[MYNTL MYPEN],
    "perawang" => %w[IDPER IDPWG],
    "pingxiang" => %w[CNZZO CNPIN],
    "pipavav" => %w[INPPV INPAV],
    "pleven" => %w[BGPVN BGSBU],
    "point-a-pitre" => %w[GPPTP GPPAP],
    "pointe des galets/reunion" => %w[REPD2 RELPT REPDG REREU],
    "pordenone" => %w[ITPRD ITPOE],
    "port kelang" => %w[MYPKG MYPSW MYXPQ MYWSP],
    "port qasim" => %w[PKBQM PKQCT],
    "port said" => %w[EGPSD EGPSE EGPSW],
    "prague" => %w[CZPRG CZN7B CZXUY],
    "puebla" => %w[MXPBC MXK6R],
    "puerto caldera" => %w[CRPTC CRCAL],
    "qingdao" => %w[CNQDG CNTAO CNQIN],
    "quanzhou" => %w[CNQZJ CNQZL],
    "quzhou" => %w[CNQZS CNJUZ],
    "reykjavik" => %w[ISREY ISREK ISKOV],
    "rio grande" => %w[BRRIG BRRGA],
    "salzgitter" => %w[DESAL DESAR],
    "san giuliano milanese" => %w[ITSGI ITSNA],
    "san juan del rio" => %w[MXSJR MXSJO],
    "san sebastian" => %w[ESEAS ESSSG],
    "san vicente" => %w[CLSVE CLSTT],
    "sanbu" => %w[CNSAU CNSBU],
    "sandy ground" => %w[AICRH AIVAL],
    "santa cruz" => %w[BOSRZ BORZA],
    "santo" => %w[VUSON VUSAN],
    "santo tomas de castilla" => %w[GTIZ4 GTSTC],
    "sao paulo" => %w[BRSAO BRBTI],
    "schwerin" => %w[DESCH DESWR],
    "sendai" => %w[JPSDJ JPSGM],
    "shanghai" => %w[CNSHA CNSHG CNSGH CNPVG],
    "shangqiu" => %w[CNSQS CNQIG],
    "shantou" => %w[CNSWA CNSHT CNSTG],
    "shanwei" => %w[CNSAW CNSWE],
    "shatian" => %w[CNSTI CNSIN],
    "shenyang" => %w[CNSHE CNSHY],
    "shenzhen" => %w[CNSNZ CNSZX],
    "shijiazhuang" => %w[CNSJZ CNSJW],
    "shuaiba" => %w[KWSAA KWHMD],
    "sohar" => %w[OMSOH OMMCT],
    "songkhla" => %w[THSGK THSGZ],
    "st. georges" => %w[GDSTG GDGND],
    "st. john's" => %w[AGSJO AGANU],
    "stuttgart" => %w[DESTU DESTR],
    "suez" => %w[EGSCN EGSUZ],
    "suzhou" => %w[CNSUH CNSZH CNSUZ],
    "taicang" => %w[CNTAC CNTGS],
    "taishan" => %w[CNTSA CNTIS],
    "taizhou" => %w[CNTAZ CNTZO],
    "tangier" => %w[MAPTM MATNG],
    "tenerife" => %w[ESTCI ESTEN],
    "tilburg" => %w[NLTBB NLTLB],
    "tokyo" => %w[JPTYO JPHND],
    "trento" => %w[ITTRT ITTOE],
    "ust-luga" => %w[RULGA RUULU],
    "vantaa" => %w[FIVNT FIVAT],
    "venice" => %w[ITVCE ITVCI],
    "victoria" => %w[CAVIC CAVIA],
    "vilnius" => %w[LTVNO LTVIL],
    "visakhapatnam" => %w[INAKP INVTZ],
    "vitoria" => %w[BRVIX BRVIT],
    "wenzhou" => %w[CNWNZ CNSXG CNWZH CNWZO],
    "wuhan" => %w[CNWUH CNNHN CNWHG],
    "wuhu" => %w[CNWHI CNWHU],
    "wujiang" => %w[CNWUJ CNWJA],
    "wujin" => %w[CNWJN CNWJI],
    "wuxi" => %w[CNWUX CNWXS],
    "xi'an" => %w[CNXIA CNSIA],
    "xiamen" => %w[CNXMG CNXMN CNXAM],
    "xiangzhou" => %w[CNXZU CNXGZ],
    "xingang" => %w[CNXGA CNTXG CNXIP CNXXI CNXGG CNXUG CNXIT],
    "xuzhou" => %w[CNXZH CNXUZ],
    "yangpu" => %w[CNYPG CNYGP],
    "yantai" => %w[CNYNT CNYAT CNYTG],
    "yibin" => %w[CNYIB CNYNZ],
    "yichang" => %w[CNYIC CNYCG],
    "yingkou" => %w[CNYIK CNYZH],
    "zhangjiang" => %w[CNZHA CNZJI],
    "zhongshan" => %w[CNZSN CNZGA],
    "zhuhai" => %w[CNZUH CNZHU],
    "zurich" => %w[CHZRH CHZUR]
  }.freeze

  def perform
    Organizations::Organization.find_each do |organization|
      GROUPS.each do |name, locodes|
        locodes.each do |locode|
          org_nexus = Legacy::Nexus.find_by(organization: organization, locode: locode)
          org_nexus ||= Legacy::Nexus.find_by(locode: locode).dup.tap { |new_nexus| new_nexus.update(organization: organization) }

          Pricings::LocationGroup.find_or_create_by(name: name, nexus: org_nexus, organization: organization)
        end
      end

      organization.scope.update(include_location_groups: true)
    end
  end
end
