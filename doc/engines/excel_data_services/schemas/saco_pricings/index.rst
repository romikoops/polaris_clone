.. _saco_pricing_uploader:

==============================================
SacoPricing uploader
==============================================

Technical document to build the saco pricing uploader.

Target Model:
=============

Pricings::Pricing

Columns:
========

+----------+-----+--------+----+---+---+---------+---------+-------+
| Header   | san | valid  | re | t | u | al      | f       | Sec   |
|          | iti | ations | qu | y | n | ternati | allback | tions |
|          | zer |        | ir | p | i | ve_keys |         |       |
|          |     |        | ed | e | q |         |         |       |
|          |     |        |    |   | u |         |         |       |
|          |     |        |    |   | e |         |         |       |
+==========+=====+========+====+===+===+=========+=========+=======+
| group_id | t   | opt    | f  | o | f |         |         |       |
|          | ext | ional_ | al | b | a |         |         |       |
|          |     | string | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| gr       | t   | opt    | f  | o | f |         |         |       |
| oup_name | ext | ional_ | al | b | a |         |         |       |
|          |     | string | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| effect   | d   | date   | f  | o | f |         |         |       |
| ive_date | ate |        | al | b | a |         |         |       |
|          |     |        | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| expirat  | d   | date   | f  | o | f |         |         |       |
| ion_date | ate |        | al | b | a |         |         |       |
|          |     |        | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| origi    | t   | opt    | f  | o | f |         |         | Itin  |
| n_locode | ext | ional_ | al | b | a |         |         | erary |
|          |     | locode | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| de       | t   | opt    | f  | o | f |         |         | Itin  |
| stinatio | ext | ional_ | al | b | a |         |         | erary |
| n_locode |     | locode | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| origin   | t   | opt    | f  | o | f |         |         | Itin  |
|          | ext | ional_ | al | b | a |         |         | erary |
|          |     | string | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| des      | t   | opt    | f  | o | f | d       |         | Itin  |
| tination | ext | ional_ | al | b | a | estinat |         | erary |
|          |     | string | se | j | l | ion_hub |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| countr   | t   | opt    | f  | o | f |         |         | Itin  |
| y_origin | ext | ional_ | al | b | a |         |         | erary |
|          |     | string | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| origin_  | t   | opt    | f  | o | f |         |         | Itin  |
| terminal | ext | ional_ | al | b | a |         |         | erary |
|          |     | string | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| dest     | t   | opt    | f  | o | f | t       |         | Itin  |
| ination_ | ext | ional_ | al | b | a | erminal |         | erary |
| terminal |     | string | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| cou      | t   | opt    | f  | o | f |         |         | Itin  |
| ntry_des | ext | ional_ | al | b | a |         |         | erary |
| tination |     | string | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| m        | t   | string | f  | o | f | mot     | ocean   | Itine |
| ode_of_t | ext |        | al | b | a |         |         | rary, |
| ransport |     |        | se | j | l |         |         | Ten   |
|          |     |        |    | e | s |         |         | antVe |
|          |     |        |    | c | e |         |         | hicle |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| carrier  | t   | string | f  | o |   |         | org     | Car   |
|          | ext |        | al | b |   |         | anizati | rier, |
|          |     |        | se | j |   |         | on.slug | Rout  |
|          |     |        |    | e |   |         |         | ingCa |
|          |     |        |    | c |   |         |         | rrier |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| service  | t   | string | f  | o |   | servic  | s       | Ten   |
|          | ext |        | al | b |   | e_level | tandard | antVe |
|          |     |        | se | j |   |         |         | hicle |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| car      | t   | string | tr | o |   |         |         |       |
| go_class | ext |        | ue | b |   |         |         |       |
|          |     |        |    | j |   |         |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| internal | b   | b      | f  | o | f |         |         |       |
|          | ool | oolean | al | b | a |         |         |       |
|          | ean |        | se | j | l |         |         |       |
|          |     |        |    | e | s |         |         |       |
|          |     |        |    | c | e |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| trans    | t   | opt    | f  | o |   | tra     |         | Itin  |
| shipment | ext | ional_ | al | b |   | nsshipm |         | erary |
|          |     | string | se | j |   | ent_via |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| wm_rate  | d   | opti   | f  | o |   |         | w       |       |
|          | eci | onal_n | al | b |   |         | m_ratio |       |
|          | mal | umeric | se | j |   |         |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| vm_rate  | d   | opti   | f  | o |   |         | v       |       |
|          | eci | onal_n | al | b |   |         | m_ratio |       |
|          | mal | umeric | se | j |   |         |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| fee_min  | d   | opti   | f  | o |   | min     |         |       |
|          | eci | onal_n | al | b |   |         |         |       |
|          | mal | umeric | se | j |   |         |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| fee_name | t   | string | f  | o |   |         |         | Char  |
|          | ext |        | al | b |   |         |         | geCat |
|          |     |        | se | j |   |         |         | egory |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| fee_code | do  | string | f  | o |   |         |         | Char  |
|          | wnc |        | al | b |   |         |         | geCat |
|          | ase |        | se | j |   |         |         | egory |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| currency | upc | cu     | tr | o |   |         |         |       |
|          | ase | rrency | ue | b |   |         |         |       |
|          |     |        |    | j |   |         |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| rate     | d   | n      | f  | o |   | fee     |         |       |
|          | eci | umeric | al | b |   |         |         |       |
|          | mal |        | se | j |   |         |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| ra       | t   | string | f  | o |   |         |         |       |
| te_basis | ext |        | al | b |   |         |         |       |
|          |     |        | se | j |   |         |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| r        | d   | opti   | f  | o |   |         |         |       |
| ange_min | eci | onal_n | al | b |   |         |         |       |
|          | mal | umeric | se | j |   |         |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| r        | d   | opti   | f  | o |   |         |         |       |
| ange_max | eci | onal_n | al | b |   |         |         |       |
|          | mal | umeric | se | j |   |         |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| base     | d   | opti   | f  | o |   |         |         |       |
|          | eci | onal_n | al | b |   |         |         |       |
|          | mal | umeric | se | j |   |         |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+
| remarks  | t   | opt    | f  | o |   |         |         |       |
|          | ext | ional_ | al | b |   |         |         |       |
|          |     | string | se | j |   |         |         |       |
|          |     |        |    | e |   |         |         |       |
|          |     |        |    | c |   |         |         |       |
|          |     |        |    | t |   |         |         |       |
+----------+-----+--------+----+---+---+---------+---------+-------+

Row Validations:
================

+----------------------------------+----------------------------------+
| Columns                          | Logic                            |
+==================================+==================================+
| ["effective_date",               | "effective_date" <               |
| "expiration_date"]               | "expiration_date"                |
+----------------------------------+----------------------------------+

Prerequisite:
=============

-  "TenantVehicle"

-  "Itinerary"

-  "ChargeCategory"

Dynamic Columns:
================

+--------------------------------+
| Including Excluding Header_row |
+--------------------------------+

--------------

Extractors:
===========

-  "Carrier"

-  "TenantVehicle"

-  "RouteHubs"

-  "Itinerary"

-  "ChargeCategory"

-  "Group"

-  "RateBasis"

Operations:
===========

-  DynamicFees

Conflicts
=========

+----------------------------------+----------------------------------+
| Model                            | Conflict keys                    |
+==================================+==================================+
| Pricings::Pricing                | itinerary_id, cargo_class,       |
|                                  | organization_id, group_id,       |
|                                  | tenant_vehicle_id                |
+----------------------------------+----------------------------------+

.. _section-1:

Formatter
=========

Pricings

Model Importer:
===============

+----------------------------------+----------------------------------+
| Model                            | options                          |
+==================================+==================================+
| Pricings::Pricing                | { recursive: true }              |
+----------------------------------+----------------------------------+
